# -*- coding: utf-8 -*-
"""start from here ecs 171 eda.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/17Kpk3fmy38zdTYq2h5je4MGFl3X96I3e

## Set Up

In this section, we import necessary python packages to run our code.

Additionally, we use Kaggle Hub to import our arabic sign language dataset.

To succesfully import the data you will need to:


*   Navigate to kaggle.com
*   Click on your profile picture in the right hand side. You will need an account for this.
* Select Settings from the drop down menu, and scroll down until you see "API".
* Create a New Token (figure below). A JSON file will be created.
* When COLAB prompts you to add your kaggle creditials, add the credientals given in the json created above.  

![Screenshot 2024-12-12 at 7.02.47 PM.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0QAAACsCAYAAABb5mxcAAABWGlDQ1BJQ0MgUHJvZmlsZQAAKJFtkL9LQlEcxY9lGOXwksYGh6ACk1KxpcUcSmh42O+263umhdrl+SKK1nantpqi/0AMWvoD2oKCaCkQag7eUvI6Vyu1uo/L+XA49/u+HKCnX0hZ8AIolmwrPT8XXN/YDPpe4OcXQBwzwijLhK4vMoJv7T7OHTxKbyfVrOrroZh9DqfO4tPHo5X609981xkws2WD+sEbNqRlA54QWd+3peIj8rDFpcgVxbkWnyvOtPiymVlOJ8k3ZM3IC5P8SA5lOvxcBxcLe8bXDmp7f7a0skQN8I5gATqCWKVGEMMUBPv5Px9r5pPYhcQBLGwjhzxsvk7QkSggS06hBANhhMgRzuNU1fPv/tqeWQeiRf5qvO3taMCVAwxV294Y+9VOgWtdCkv8tOpxvOWtaKTFgzWg78R139YA3wTQuHfd95rrNi6A3ge+dT4BXMtj/GxIHvMAAABWZVhJZk1NACoAAAAIAAGHaQAEAAAAAQAAABoAAAAAAAOShgAHAAAAEgAAAESgAgAEAAAAAQAAA0SgAwAEAAAAAQAAAKwAAAAAQVNDSUkAAABTY3JlZW5zaG90ePdxmgAAAdZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTcyPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjgzNjwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlVzZXJDb21tZW50PlNjcmVlbnNob3Q8L2V4aWY6VXNlckNvbW1lbnQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpYKgXjAABAAElEQVR4Ae2dB5gVNReGD7D0XkRUVEB6kaooSlFEbAioFAFFpYNIkyaCIlVQRGwIijRFioCCIL2IKEiRJr0X+ZUmve+fL7sZZ4d778zd3bv1O8+zO3NnMpnkzZlMTnKSSRGuRCgkQAIkQAIkQAIkQAIkQAIkkAwJpEyGeWaWSYAESIAESIAESIAESIAESEAToEFERSABEiABEiABEiABEiABEki2BGgQJduiZ8ZJgARIgARIgARIgARIgARoEFEHSIAESIAESIAESIAESIAEki0BGkTJtuiZcRIgARIgARIgARIgARIgARpE1AESIAESIAESIAESIAESIIFkS4AGUbItemacBEiABEiABEiABEiABEiABhF1gARIgARIgARIgARIgARIINkSoEGUbIueGScBEiABEiABEiABEiABEqBBRB0gARIgARIgARIgARIgARJItgRoECXbomfGSYAESIAESIAESIAESIAEaBBRB0iABEiABEiABEiABEiABJItARpEybbomXESIAESIAESIAESIAESIAEaRNQBEiABEiABEiABEiABEiCBZEuABlGyLXpmnARIgARIgARIgARIgARIgAYRdYAESIAESIAESIAESIAESCDZEqBBlGyLnhknARIgARIgARIgARIgARKgQUQdIAESIAESIAESIAESIAESSLYEaBAl26JnxkmABEiABEiABEiABEiABGgQUQdIgARIgARIgARIgARIgASSLQEaRMm26JlxEiABEiABEiABEiABEiABGkTUARIgARIgARIgARIgARIggWRLgAZRsi16ZpwESIAESIAESIAESIAESIAGEXWABEiABEiABEiABEiABEgg2RKgQZRsi54ZJwESIAESIAESIAESIAESoEFEHSABEiABEiABEiABEiABEki2BGgQJduiZ8ZJgARIgARIgARIgARIgATCEgqCDRs2Sr/+/aMk54vRoyRbtmxRjuHHxo2b5J1+/W44HhaWWkqWKCHlypWVihUrSs6cOaww9mtyZM8ho0aNtM5xhwRIgARIgARIgARIgARIIHkSSDAG0fQZM2T16t+jlMK8+fOlQf36UY7hx6lTp24IawKtXLlS7+bMmVOmTZ0sd911l/5tvwbnKCRAAiRAAiRAAiRAAiRAAiSQIFzmrl69JlOnTL2hNKZ/N+OGY74OwMBxGjnHjx+XWrVqy9GjR31dwmMkQAIkQAIkQAIkQAIkQAIkIAnCIFq9epWcPXdOF8cdd9xhFcuvv/3matDAEFq/bo3+27Z1iwwd+q51PeJctny59Zs7JEACJEACJEACJEACJEACJGAnkCAMotk/zrHS9NRTT0qFChWs33PmzLX23XYyZMigXewQhxGnG545zi0JkAAJkAAJkAAJkAAJkAAJxLtBdOXKFZk5Y6ZVEpXuv18eqlbV+j3tu+nWvtedPHnyWEHpMmeh4A4JkAAJkAAJkAAJkAAJkICDQLwbRL/8stJyl0PaKlQoL1WqVLGSuXnzZtm9Z4/1223nzJkzMn/+AivYPffcY+1zhwRIgARIgARIgARIgARIgATsBOJ9lblZs2db6alUqZLA7a1kyRKSKWNGy1D6UbnUvdb+VSucfQeLJ8yYOVPCw0UOHDggs2bN1lsT5t57/nO/M8e4JQESIAESIAESIAESIAESIAEQiFeD6OLFizJ16jSrJGrWfFTvp0qVSurUrSMTJ36tf09RK9D5M4gQoEOHTjqc81/btm0ERhaFBEiABEiABEiABEiABEiABHwRiFeD6OefV0RJ01tvvS1DhwzVx8yqc/iBkZ9NmzZJqVKlooT396NkyZJSr95z8vJLTf0F4XESIAESIAESIAESIAESIAESiN8RIri3OcVuCNnPzZ79o1+DaObMiIUXUoeFScGCBSV9+vT2S7lPAiRAAiRAAiRAAiRAAiRAAj4JxNsI0blz52Xm999HSdQLLzSJ8nvChInW7ynKta5bt64Cdzq74DtE5cqWtR/iPgmQAAmQAAmQAAmQAAmQAAl4IhBvBtHSpUujJHDRwvlSqFChKMdqPvqoNHnhRX0Miyf8/vsaue++ilHC8AcJkAAJkAAJkAAJkAAJkAAJRJdAvC27bXeXK1Ag/w3GEDJ0//336dXmTOZ+mDXL7HJLAiRAAiRAAiRAAiRAAiRAAjEmEC8G0YULF2TO3LlW4p+uVcvat++kTp1ann76v3P4gOu1a9ckZcrgkx2da+xp4T4JkAAJkAAJkAAJkAAJkEDSI5AiXEnSyxZzRAIkQAIkQAIkQAIkQAIkQALuBIIfanGPkyFIgARIgARIgARIgARIgARIIFEQoEGUKIqJiSQBEiABEiABEiABEiABEggFARpEoaDKOEmABEiABEiABEiABEiABBIFARpEiaKYmEgSIAESIAESIAESIAESIIFQEKBBFAqqjJMESIAESIAESIAESIAESCBREKBBlCiKiYkkARIgARIgARIgARIgARIIBQEaRKGgyjhJgARIgARIgARIgARIgAQSBQEaRImimJhIEiABEiABEiABEiABEiCBUBCgQRQKqoyTBEiABEiABEiABEiABEggURCgQZQoiomJJAESIAESIAESIAESIAESCAUBGkShoMo4SYAESIAESIAESIAESIAEEgUBGkSJopiYSBIgARIgARIgARIgARIggVAQoEEUCqqMkwRIgARIgARIgARIgARIIFEQoEGUKIqJiSQBEiABEiABEiABEiABEggFARpEoaDKOEmABEiABEiABEiABEiABBIFARpEiaKYmEgSIAESIAESIAESIAESIIFQEKBBFAqqjJMESIAESIAESIAESIAESCBREKBBlCiKiYkkARIgARIgARIgARIgARIIBQEaRKGgyjhJgARIgARIgARIgARIgAQSBQEaRImimJhIEiABEiABEiABEiABEiCBUBCgQRQKqoyTBEiABEiABEiABEiABEggURCgQZQoiomJJAESIAESIAESIAESIAESCAUBGkShoMo4SYAESIAESIAESIAESIAEEgUBGkSJopiYSBIgARIgARIgARIgARIggVAQSPW2klBE7BbnP8eOye9r1sktefJIWFiqKMH/3LpNjvx1VPLcnDvKcV8/Jk/9TvYfOCiFCxX0dTrGx/yl8/DhI7Lujw06/mzZssb4Pl4iWLZ8haRPl04yZcroGvx///tb1qxbL3lvu1VSpgzO7v339Gn5bdXvmn9YWJjrvUId4MqVK/LzL7/K2bPnJHfum6Lczpzbt/+A4A/lkiZ1asUokxXOXxlaAZLZzsFDh2XMVxP0M5MhQ/pklvuI7F66dEk+GTlaMmXMeINOGSDBPG/mGmzDw8Nl9569svznX+Svo0cla5Yskj594uO8avUamTV7jlQoX1ZSpEhhz6Ledzt/wwWJ4MDadX/IhQsXJEf27DekFvXIV+Mmyql//xU8Q6dPnxHU/QmhjrwhsYngQCDWoU7+gYMHZdv2nfr9GKp7oQ7Y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HSsYE00kodKjRAOACSUBEiABEiCBREYgQRlEht2mP7fLiVP/StGCBbj6nIHCbUgJYBUwLKCAOUMxcZMLlEjqdSA6SeNcXOhR0iDFXJAACZAACZBAwiGQIA0i4Dn69z+yY9c+SZcujdyZ9zYaRglHZ5JUStCAxfdhLl68rFeTi84CCsEAoV4HQyvxhI1rPUo8ZJhSEiABEiABEkj4BBKsQWTQHTpyVA4eOiLnL16U3LlySnbVg58lcyZJny6dhIWF0a3OgOI2IAG4MV29elUuKD06feasnFQjkH8fOy4ZlB7hQ6p5b80T8PrYPkm9jm2icRNfQtOjuMk170ICJEACJEACSZtAgjeIDP6z587LseMnVEP2tJxRczwuqoYtGriqnUshAVcCKVQIGNDplAGUWc1Ry54ti+TKmUMyZczgem0oA1CvQ0k39uNOqHoU+zlljCRAAiRAAiSQfAgkGoMo+RQJc0oCJEACJEACJEACJEACJBBXBBLMsttxlWHehwRIgARIgARIgARIgARIgAQMARpEhgS3JEACJEACJEACJEACJEACyY4ADaJkV+TMMAmQAAmQAAmQAAmQAAmQgCFAg8iQ4JYESIAESIAESIAESIAESCDZEaBBlOyKnBkmARIgARIgARIgARIgARIwBGgQGRLckgAJkAAJkAAJkAAJkAAJJDsCNIiSXZEzwyRAAiRAAiRAAiRAAiRAAoYADSJDglsSIAESIAESIAESIAESIIFkR4AGUbIrcmaYBEiABEiABEiABEiABEjAEKBBZEhwSwIkQAIkQAIkQAIkQAIkkOwI0CBKdkXODJMACZAACZAACZAACZAACRgCNIgMCW5JgARIgARIgARIgARIgASSHQEaRMmuyJlhEiABEiABEiABEiABEiABQ4AGkSHBLQmQAAmQAAmQAAmQAAmQQLIjQIMo2RU5M0wCJEACJEACJEACJEACJGAI0CAyJLglARIgARIgARIgARIgARJIdgRoECW7ImeGSYAESIAESIAESIAESIAEDAEaRIYEtyRAAiRAAiRAAiRAAiRAAsmOAA2iZFfkzDAJkAAJkAAJkAAJkAAJkIAh8H8DcfXVh9t0+AAAAABJRU5ErkJggg==)

# New Section
"""

import kagglehub
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import os
from sklearn.preprocessing import StandardScaler, MinMaxScaler

kagglehub.login()

"""## Import and Inspect the Data

Import the data set.
"""

dataset_path = kagglehub.dataset_download("maharshipandya/-spotify-tracks-dataset")
print(dataset_path)

"""Check how the data was imported. It is 1 CSV."""

def count_files(datapath):
    file_count = 0
    for root, dirs, files in os.walk(datapath):
        file_count += len(files)
    return file_count

datapath = dataset_path # Replace with the actual path
num_files = count_files(datapath)
print(f"The number of files in {datapath} is: {num_files}")

"""Get the mean, count, and percentiles for each feature."""

df = pd.read_csv(dataset_path + "/dataset.csv")

# get initial information
#print(df.head())
print(df.describe())

print("Row count: ", df.shape[0])
print("Col count: ", df.shape[1])
print("Col names ", df.columns.tolist())
column_types = df.dtypes
print("Column Types" , column_types)

unique_values = df['track_genre'].unique()
value_counts = df['track_genre'].value_counts()
print("Unique Tracks per genre ", value_counts)

"""## Handle Missing Data

Looking at all of the columns in the code, there is not a concering amount of missing data in each column, with 0-1 missing values per column.
"""

df.isnull().sum()

"""##Explore Data Characteristics"""

# Plot histograms for some of the features
features_to_plot = ['acousticness', 'instrumentalness', 'valence', 'danceability', 'duration_ms', 'energy', 'loudness', 'speechiness', 'tempo']
plt.figure(figsize=(12, 8))
for i, feature in enumerate(features_to_plot, 1):
    plt.subplot(3, 3, i)
    sns.histplot(df[feature], kde=True)
    plt.title(feature)

plt.tight_layout()
plt.show()

print("\nmean:\n{} , \nmedian:\n{} , \nstd:\n {}".format(df[features_to_plot].mean() , df[features_to_plot].median(), df[features_to_plot].std()))

"""The data is skewed to the right for speechiness, as the median is less than the mean. The data is skewed left for energy and popularity, as the mean is less than median. The data is normally distrubted for tempo.

## Perform Data Transformation

Transforming the data using min-max to ensure that the data scales values to between 0 and 1.
"""

# Plot standarized values for features from feature selection
mmscaler = MinMaxScaler()
features_to_scale = ['acousticness', 'instrumentalness', 'valence', 'danceability', 'duration_ms', 'energy', 'loudness', 'speechiness', 'tempo']
mm_data = mmscaler.fit_transform(df[features_to_scale])
df_mm_data = pd.DataFrame(mm_data, columns=features_to_scale)


plt.figure(figsize=(12, 8))
for i, feature in enumerate(features_to_scale, 1):
    plt.subplot(3, 3, i)
    sns.histplot(df_mm_data[feature], kde=True)
    plt.title(feature)

plt.tight_layout()
plt.show()

print("\nmean:\n{} , \nmedian:\n{} , \nstd:\n {}".format(df_mm_data[features_to_scale].mean() , df_mm_data[features_to_scale].median(), df_mm_data[features_to_scale].std()))

"""#Correlation Matrix"""

numbers_df = df.iloc[:,5:20]
numbers_df

corrmat = numbers_df.corr()
top_corr_features = corrmat.index
plt.figure(figsize=(20,20))
#plot heat map
g=sns.heatmap(numbers_df[top_corr_features].corr(),annot=True,cmap="RdYlGn")

"""#Change Categorical Data and Scale all features"""

from sklearn.preprocessing import OneHotEncoder

onehot = OneHotEncoder(sparse_output=False)
genre_encoded = onehot.fit_transform(df[['track_genre']])
genre_names = onehot.categories_[0]

genre_encoded_df = pd.DataFrame(genre_encoded, columns=genre_names)

columns_to_drop = ['track_id', 'artists', 'album_name', 'track_name', 'track_genre']
df_with_encoded_genres = pd.concat([df, genre_encoded_df], axis=1)
df_with_encoded_genres = df_with_encoded_genres.drop(columns=columns_to_drop)

print("Shape of final dataframe with encoded genres:", df_with_encoded_genres.shape)
print("\nColumns in the final dataframe:")
print(df_with_encoded_genres.columns.tolist())

print("\nFirst few rows of the cleaned dataframe (including track_genre):")
print(df_with_encoded_genres.head())

mmscaler = MinMaxScaler()
mm_datax = mmscaler.fit_transform(df_with_encoded_genres)
df_mm_data = pd.DataFrame(mm_datax, columns=df_with_encoded_genres.columns)
print(df_mm_data.columns.tolist())
df_mm_data.head()

"""###Use Above for your model, it is scaled and one hot encoded

#Feature Selection
"""

from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import xgboost as xgb

numerical_columns = ['duration_ms', 'danceability', 'energy', 'key',
                    'loudness', 'mode', 'speechiness', 'acousticness', 'instrumentalness',
                    'liveness', 'valence', 'tempo', 'time_signature']

genre_columns = df_with_encoded_genres.columns.difference(numerical_columns)
feature_columns = [col for col in numerical_columns if col != 'popularity']
feature_columns.extend(genre_columns)


X = df_mm_data[feature_columns]
y = df_mm_data['popularity']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state=24)

xgb_model = xgb.XGBRegressor(
    objective='reg:squarederror',
    learning_rate=0.1,
    max_depth=6,
    n_estimators=100,
    subsample=0.8,
    colsample_bytree=0.8,
    random_state=42
)

xgb_model.fit(X_train, y_train)

# Feature importance analysis

importance_df = pd.DataFrame({
    'feature': feature_columns,
    'importance': xgb_model.feature_importances_
})
importance_df = importance_df.sort_values('importance', ascending=False)

print("\nTop 10 Features by Importance:")
print(importance_df.head(10))

"""This says track genre is the most important.

## Remove genres, predict based on numerical columns
"""

from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import xgboost as xgb

numerical_columns = ['duration_ms', 'danceability', 'energy',
                    'loudness', 'speechiness', 'acousticness', 'instrumentalness',
                    'liveness', 'valence', 'tempo']

X = df_mm_data[numerical_columns]
y = df_mm_data['popularity']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state=24)

xgb_model = xgb.XGBRegressor(
    objective='reg:squarederror',
    learning_rate=0.1,
    max_depth=6,
    n_estimators=100,
    subsample=0.8,
    colsample_bytree=0.8,
    random_state=42
)

xgb_model.fit(X_train, y_train)

y_pred = xgb_model.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print("\nModel Performance Metrics:")
print(f"Root Mean Squared Error: {rmse:.4f}")
print(f"Mean Absolute Error: {mae:.4f}")
print(f"R-squared Score: {r2:.4f}")


# Feature importance analysis

importance_df = pd.DataFrame({
    'feature': numerical_columns,
    'importance': xgb_model.feature_importances_
})
importance_df = importance_df.sort_values('importance', ascending=False)

print("\nTop 10 Features by Importance:")
print(importance_df.head(10))

"""# Linear Regression Model"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import matplotlib.pyplot as plt
import seaborn as sns
import kagglehub
from sklearn.preprocessing import StandardScaler, OneHotEncoder

dataset_path = kagglehub.dataset_download("maharshipandya/-spotify-tracks-dataset")

df = pd.read_csv(dataset_path + "/dataset.csv")
df = df.dropna()

onehot = OneHotEncoder(sparse_output=False)
genre_encoded = onehot.fit_transform(df[['track_genre']])
genre_names = onehot.categories_[0]
genre_encoded_df = pd.DataFrame(genre_encoded, columns=genre_names)

columns_to_drop = ['track_id', 'artists', 'album_name', 'track_name', 'track_genre']
df_with_encoded_genres = pd.concat([df, genre_encoded_df], axis=1)
df_with_encoded_genres = df_with_encoded_genres.drop(columns=columns_to_drop)

df_with_encoded_genres = df_with_encoded_genres.dropna()

numerical_features = ['danceability', 'energy', 'loudness', 'speechiness', 'acousticness', 'instrumentalness', 'valence', 'tempo']
features = numerical_features + list(genre_names)
target = 'popularity'

X = df_with_encoded_genres[features]
y = df_with_encoded_genres[target]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)

scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

model=LinearRegression()
model.fit(X_train,y_train)

y_pred=model.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
mean_actual = np.mean(y_test)
relative_accuracy = 1 - (mae / mean_actual)

print("Mean Squared Error (MSE):", round(mse, 2))
print("R-squared (R2):", round(r2, 3))
print("Mean Absolute Error (MAE):", round(mae, 2))
print(f"Relative Accuracy: {relative_accuracy * 100:.2f}%")

plt.figure(figsize=(12, 8))
sns.scatterplot(x=y_test, y=y_pred)
plt.xlabel("Actual Popularity")
plt.ylabel("Predicted Popularity")
plt.title("Linear Regression: Predicted vs Actual Popularity")

min_val = min(min(y_test), min(y_pred))
max_val = max(max(y_test), max(y_pred))
plt.plot([min_val, max_val], [min_val, max_val], 'r--', linewidth=2, label='Perfect Prediction')
plt.grid(True)
plt.legend()
plt.show()

"""# Lasso Regression Model"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler, OneHotEncoder
from sklearn.linear_model import Lasso
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import matplotlib.pyplot as plt
import seaborn as sns
import kagglehub

dataset_path = kagglehub.dataset_download("maharshipandya/-spotify-tracks-dataset")

df = pd.read_csv(dataset_path + "/dataset.csv")
df = df.dropna()

onehot = OneHotEncoder(sparse_output=False)
genre_encoded = onehot.fit_transform(df[['track_genre']])
genre_names = onehot.categories_[0]
genre_encoded_df = pd.DataFrame(genre_encoded, columns=genre_names)

columns_to_drop = ['track_id', 'artists', 'album_name', 'track_name', 'track_genre']
df_with_encoded_genres = pd.concat([df, genre_encoded_df], axis=1)
df_with_encoded_genres = df_with_encoded_genres.drop(columns=columns_to_drop)

df_with_encoded_genres = df_with_encoded_genres.dropna()

numerical_features = ['danceability', 'energy', 'loudness', 'speechiness', 'acousticness', 'instrumentalness', 'valence', 'tempo']
features = numerical_features + list(genre_names)
target = 'popularity'

X = df_with_encoded_genres[features]
y = df_with_encoded_genres[target]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)

scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

model = Lasso(alpha=0.01)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
mean_actual = np.mean(y_test)
relative_accuracy = 1 - (mae / mean_actual)

print("Mean Squared Error (MSE):", round(mse, 2))
print("R-squared (R2):", round(r2, 3))
print("Mean Absolute Error (MAE):", round(mae, 2))
print(f"Relative Accuracy: {relative_accuracy * 100:.2f}%")

plt.figure(figsize=(12, 8))
sns.scatterplot(x=y_test, y=y_pred)
plt.xlabel('Actual Popularity')
plt.ylabel('Predicted Popularity')
plt.title("Lasso Regression: Predicted vs Actual Popularity")

min_val = min(min(y_test), min(y_pred))
max_val = max(max(y_test), max(y_pred))
plt.plot([min_val, max_val], [min_val, max_val], 'r--', linewidth=2, label='Perfect Prediction')
plt.grid(True)
plt.legend()
plt.show()

"""# Random Forest Regressor"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler, OneHotEncoder
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import kagglehub
import joblib

dataset_path = kagglehub.dataset_download("maharshipandya/-spotify-tracks-dataset")
df = pd.read_csv(dataset_path + "/dataset.csv")

df = df.dropna()

onehot = OneHotEncoder(sparse_output=False)
genre_encoded = onehot.fit_transform(df[['track_genre']])
genre_names = onehot.categories_[0]
genre_encoded_df = pd.DataFrame(genre_encoded, columns=genre_names)

columns_to_drop = ['track_id', 'artists', 'album_name', 'track_name', 'track_genre']
df_with_encoded_genres = pd.concat([df, genre_encoded_df], axis=1)
df_with_encoded_genres = df_with_encoded_genres.drop(columns=columns_to_drop)

numerical_features = [
    'danceability', 'energy', 'loudness', 'speechiness', 'acousticness',
    'instrumentalness', 'liveness', 'valence', 'tempo'
]
features = numerical_features + list(genre_names)
target = 'popularity'

df_clean = df_with_encoded_genres.dropna(subset=features + [target])
df_sample = df_clean.sample(n=100000, random_state=42)

X = df_sample[features]
y = df_sample[target]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)

forest = RandomForestRegressor(n_estimators=500, max_depth=30, min_samples_split=5, min_samples_leaf=2, max_features='sqrt', bootstrap=True, random_state=42, n_jobs=-1)
forest.fit(X_train, y_train)

y_pred = forest.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
accuracy = 100 * (1 - (np.sum(np.abs(y_test - y_pred)) / np.sum(np.abs(y_test - np.mean(y_test)))))

print("Random Forest Regressor")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"R² Score: {r2:.3f}")
print(f"Mean Absolute Error (MAE): {mae:.2f}")
print(f"Relative Accuracy: {accuracy:.2f}%")

plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred, alpha=0.3, edgecolors='k')
plt.xlabel("Actual Popularity")
plt.ylabel("Predicted Popularity")
plt.title("Predicted vs Actual Popularity")
plt.grid(True)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'r--')
plt.tight_layout()
plt.show()

importances = forest.feature_importances_
indices = np.argsort(importances)[::-1]
sorted_features = [features[i] for i in indices]

plt.figure(figsize=(10, 6))
plt.bar(range(len(features)), importances[indices], align='center')
plt.xticks(range(len(features)), sorted_features, rotation=45)
plt.title("Feature Importances")
plt.ylabel("Importance Score")
plt.tight_layout()
plt.show()

joblib.dump(forest, 'models/random_forest.pkl')
joblib.dump(features, 'models/feature_columns_rf.pkl')

"""# K-Means Clustering"""

import kagglehub
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import os
from sklearn.preprocessing import StandardScaler, MinMaxScaler

dataset_path = kagglehub.dataset_download("maharshipandya/-spotify-tracks-dataset")
print(dataset_path)

df = pd.read_csv(dataset_path + "/dataset.csv")

features = [
    'danceability', 'energy', 'loudness', 'speechiness', 'acousticness',
    'instrumentalness', 'liveness', 'valence', 'tempo'
]
target = 'popularity'

df_clean = df.dropna(subset=features + [target])
df_sample = df_clean.sample(n=100000, random_state=42)

X = df_sample[features]
y = df_sample[target]

features = ['tempo', 'valence', 'energy', 'danceability', 'loudness']
df_clean = df[features].dropna()

from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_scaled = scaler.fit_transform(df_clean)
from sklearn.cluster import KMeans

inertia = []
K = range(1, 11)


optimal_k = 4
kmeans = KMeans(n_clusters=optimal_k, random_state=42)
df['cluster'] = kmeans.fit_predict(X_scaled)

cluster_summary = df.groupby('cluster')[features].mean()
print(cluster_summary)

sns.boxplot(x='cluster', y='popularity', data=df)
plt.title("Popularity Distribution by Cluster")
plt.xlabel("Cluster Label")
plt.ylabel("Popularity")
plt.show()

print("KMeans Inertia:", kmeans.inertia_)

from sklearn.decomposition import PCA
import seaborn as sns
import matplotlib.pyplot as plt

pca = PCA(n_components=2)
X_pca = pca.fit_transform(X_scaled)

df['pca1'] = X_pca[:, 0]
df['pca2'] = X_pca[:, 1]

plt.figure(figsize=(8,6))
sns.scatterplot(data=df, x='pca1', y='pca2', hue='cluster', palette='Set2')
plt.title("K-Means Clusters Visualized with PCA")
plt.show()

def recommend_similar(song_index, df, indices):
    print(" Target Song Features:")
    print(df.iloc[song_index][features])
    print("\n Recommended Songs (feature similarity):")
    return df.iloc[indices[song_index][1:]][features]

df['popularity_label'] = pd.cut(df['popularity'], bins=[0, 40, 70, 100], labels=['Low', 'Medium', 'High'])

pd.crosstab(df['cluster'], df['popularity_label'], normalize='index')  # row-wise percentages